<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON to Go Struct Converter｜Simple Tools</title>
    <meta name="description" content="JSONデータからGo言語の構造体（Struct）定義を自動生成するツール。jsonタグの付与やネストされたオブジェクトの型推論に対応。" />

    <link rel="stylesheet" href="/assets/css/style.css">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4KCLTYQ3D1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-4KCLTYQ3D1');
    </script>
</head>

<body>
    <header>
        <h1>JSON to Go Struct</h1>
        <p class="subtitle">JSONからGo構造体を自動生成</p>
    </header>

    <div class="back-nav">
        <a href="/"><span>←</span> Home</a>
    </div>

    <main class="tool-container">

        <div style="margin-bottom: 2rem;">
            <div style="display: flex; gap: 1rem; align-items: flex-end; margin-bottom: 1rem;">
                <div style="flex: 1;">
                    <label for="struct-name" style="font-weight: bold; color: var(--text-muted); font-size: 0.9em;">構造体名
                        (Struct Name)</label>
                    <input type="text" id="struct-name" value="AutoGenerated"
                        style="width: 100%; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; padding: 0.5rem; border-radius: 4px;">
                </div>
                <button id="btn-convert" class="action-btn" style="padding: 0.7rem 2rem;">変換 (Convert)</button>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; align-items: stretch;">
            <!-- JSON Input -->
            <div class="group">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <label>JSON Input</label>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="secondary-btn" id="btn-sample">サンプル</button>
                        <button class="secondary-btn" id="btn-clear"
                            style="color: #ff6b6b; border-color: rgba(255,107,107,0.3);">クリア</button>
                    </div>
                </div>
                <textarea id="input-json" placeholder='{"id": 1, "name": "example"}'
                    style="height: 400px; font-family: monospace;"></textarea>
            </div>

            <!-- Google Code Output -->
            <div class="group">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <label>Go Struct</label>
                    <button class="copy-btn" id="btn-copy">コピー</button>
                </div>
                <textarea id="output-go" readonly placeholder="type AutoGenerated struct { ... }"
                    style="height: 400px; color: var(--accent); font-family: monospace; white-space: pre;"></textarea>
            </div>
        </div>

        <div id="error-msg" style="color: #ff6b6b; margin-top: 1rem; display: none; text-align: center;"></div>

    </main>

    <footer>
        <p>&copy; 2026 Simple Tools. All rights reserved.</p>
    </footer>

    <!-- Logic Script -->
    <script type="module">
        import { JsonToGoLogic } from '../assets/js/modules/json-to-go-logic.js';

        const inputJson = document.getElementById('input-json');
        const outputGo = document.getElementById('output-go');
        const structName = document.getElementById('struct-name');

        const btnConvert = document.getElementById('btn-convert');
        const btnClear = document.getElementById('btn-clear');
        const btnCopy = document.getElementById('btn-copy');
        const btnSample = document.getElementById('btn-sample');

        const errorMsg = document.getElementById('error-msg');

        const convert = () => {
            errorMsg.style.display = 'none';
            const json = inputJson.value.trim();
            const name = structName.value.trim() || 'AutoGenerated';

            if (!json) {
                outputGo.value = '';
                return;
            }

            try {
                outputGo.value = JsonToGoLogic.convert(json, name);
            } catch (e) {
                errorMsg.textContent = 'エラー: ' + e.message;
                errorMsg.style.display = 'block';
            }
        };

        btnConvert.addEventListener('click', convert);

        btnSample.addEventListener('click', () => {
            inputJson.value = `{
  "id": 101,
  "user_name": "gopher",
  "is_active": true,
  "roles": ["admin", "editor"],
  "stats": {
    "login_count": 42,
    "last_seen": "2026-01-16"
  }
}`;
            convert();
        });

        btnClear.addEventListener('click', () => {
            inputJson.value = '';
            outputGo.value = '';
            inputJson.focus();
        });

        btnCopy.addEventListener('click', () => {
            if (!outputGo.value) return;
            navigator.clipboard.writeText(outputGo.value).then(() => {
                const original = btnCopy.textContent;
                btnCopy.textContent = 'Copied!';
                setTimeout(() => btnCopy.textContent = original, 2000);
            });
        });

    </script>
</body>

</html>