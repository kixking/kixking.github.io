<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>単位変換ツール (Unit Converter)｜Simple Tools</title>
    <meta name="description" content="長さ、重さ、データ容量、Web単位(px/rem)などをリアルタイムで計算・変換できる便利ツールです。" />

    <link rel="stylesheet" href="/assets/css/style.css">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4KCLTYQ3D1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-4KCLTYQ3D1');
    </script>
</head>

<body>
    <header>
        <h1>Unit Converter</h1>
        <p class="subtitle">Web制作や日常で使える単位変換</p>
    </header>

    <div class="back-nav">
        <a href="/"><span>←</span> Home</a>
    </div>

    <main class="tool-container">

        <!-- Category Tabs -->
        <div class="category-tabs"
            style="display: flex; gap: 0.5rem; overflow-x: auto; margin-bottom: 2rem; padding-bottom: 0.5rem;">
            <button class="filter-chip active" data-cat="length">長さ (Length)</button>
            <button class="filter-chip" data-cat="weight">重さ (Weight)</button>
            <button class="filter-chip" data-cat="data">データ (Data)</button>
            <button class="filter-chip" data-cat="web">Web (px/rem)</button>
        </div>

        <!-- Web Config (Hidden by default) -->
        <div id="web-config"
            style="display: none; margin-bottom: 2rem; padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 8px;">
            <label style="display: flex; align-items: center; gap: 1rem;">
                Root Font Size (1rem):
                <input type="number" id="root-font-size" value="16" style="width: 80px; padding: 0.3rem;"> px
            </label>
        </div>

        <!-- Converter Interface -->
        <div class="converter-box"
            style="display: flex; flex-direction: column; gap: 1.5rem; background: rgba(0,0,0,0.2); padding: 2rem; border-radius: 1rem; border: 1px solid rgba(255,255,255,0.1);">

            <!-- FROM -->
            <div style="display: flex; gap: 1rem; align-items: center;">
                <div style="flex: 2;">
                    <label
                        style="display: block; font-size: 0.8rem; margin-bottom: 0.3rem; color: var(--text-muted);">From</label>
                    <input type="number" id="input-from" placeholder="0" style="font-size: 1.5rem; padding: 0.5rem;">
                </div>
                <div style="flex: 1;">
                    <label
                        style="display: block; font-size: 0.8rem; margin-bottom: 0.3rem; color: var(--text-muted);">Unit</label>
                    <select id="select-from" style="width: 100%; padding: 0.5rem;"></select>
                </div>
            </div>

            <div style="text-align: center; color: var(--primary); font-size: 1.5rem;">⬇</div>

            <!-- TO -->
            <div style="display: flex; gap: 1rem; align-items: center;">
                <div style="flex: 2;">
                    <label
                        style="display: block; font-size: 0.8rem; margin-bottom: 0.3rem; color: var(--text-muted);">To</label>
                    <input type="number" id="input-to" readonly placeholder="0"
                        style="font-size: 1.5rem; padding: 0.5rem; background: rgba(0,0,0,0.3); color: var(--accent);">
                </div>
                <div style="flex: 1;">
                    <label
                        style="display: block; font-size: 0.8rem; margin-bottom: 0.3rem; color: var(--text-muted);">Unit</label>
                    <select id="select-to" style="width: 100%; padding: 0.5rem;"></select>
                </div>
            </div>

        </div>

    </main>

    <footer>
        <p>&copy; 2026 Simple Tools. All rights reserved.</p>
    </footer>

    <!-- Logic Script -->
    <script type="module">
        import { UnitConverterLogic } from '../assets/js/modules/unit-converter-logic.js';

        const tabs = document.querySelectorAll('.filter-chip');
        const webConfig = document.getElementById('web-config');
        const rootFontSizeInput = document.getElementById('root-font-size');

        const inputFrom = document.getElementById('input-from');
        const inputTo = document.getElementById('input-to');
        const selectFrom = document.getElementById('select-from');
        const selectTo = document.getElementById('select-to');

        let currentCategory = 'length';

        // Initialize Options
        const populateSelects = (category) => {
            const units = UnitConverterLogic.getUnits(category);
            selectFrom.innerHTML = '';
            selectTo.innerHTML = '';

            units.forEach(u => {
                const opt1 = new Option(u, u);
                const opt2 = new Option(u, u);
                selectFrom.add(opt1);
                selectTo.add(opt2);
            });

            // Set defaults if possible (e.g. m -> cm)
            if (units.length >= 2) {
                selectTo.value = units[1];
            }
        };

        // Switch Category
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Style
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Logic
                currentCategory = tab.dataset.cat;
                populateSelects(currentCategory);

                // Show/Hide Web Config
                if (currentCategory === 'web') {
                    webConfig.style.display = 'block';
                } else {
                    webConfig.style.display = 'none';
                }

                recalc();
            });
        });

        // Calculation
        const recalc = () => {
            const val = parseFloat(inputFrom.value);
            const fromUnit = selectFrom.value;
            const toUnit = selectTo.value;

            if (isNaN(val)) {
                inputTo.value = '';
                return;
            }

            // Update web config if needed
            if (currentCategory === 'web') {
                const rootSize = parseFloat(rootFontSizeInput.value) || 16;
                UnitConverterLogic.setRootFontSize(rootSize);
            }

            try {
                const result = UnitConverterLogic.convert(val, fromUnit, toUnit, currentCategory);
                // Format output (avoid tiny float errors like 3.0000000004)
                inputTo.value = parseFloat(result.toFixed(6));
            } catch (e) {
                console.error(e);
                inputTo.value = 'Error';
            }
        };

        // Events
        inputFrom.addEventListener('input', recalc);
        selectFrom.addEventListener('change', recalc);
        selectTo.addEventListener('change', recalc);
        rootFontSizeInput.addEventListener('input', recalc);

        // Init
        populateSelects('length');
        // Default Length: m -> km. Let's set to m -> cm for better demo
        selectFrom.value = 'm';
        selectTo.value = 'cm';

    </script>
</body>

</html>